@model TagListVM


<div class="card">
    <div class="card-header bg-warning text-center fs-4">Etiket Listesi</div>
    <div class="card-body">
        <a href="#" class="btn btn-success" data-bs-toggle="modal"
           data-bs-target="#modalEkle">Ekle</a>
        <table class="table table-bordered table-hover table-striped">
        </table>
    </div>
    <div class="card-footer">Toplam Kayıt : @Model.Tags.Count</div>
</div>

<div class="modal fade"
     id="modalEkle"
     tabindex="-1"
     data-bs-backdrop="static"
     data-bs-keyboard="false"
     role="dialog"
     aria-labelledby="modalTitleId"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm"
         role="document">
        <form method="post" asp-action="Add">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitleId">
                        Yeni Etiket Ekle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">


                    <input asp-for="Tag.Name" class="form-control" placeholder="Lütfen etiket adı giriniz" />







                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Kapat </button>
                    <button type="submit" class="btn btn-primary"> Kaydet </button>
                </div>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        var DataTable = $("table").DataTable({
            ajax: '/Tag/GetAll',
            columns: [
                { data: 'id', title: 'ID' },
                { data: 'name', title: 'Etiket Adı' },
                {
                    data: 'id', title: 'İşlemler', render: function (data, type, row) {

                        return `<a onclick="deleteTag(${data},this)" class="btn btn-danger">Sil</a>`;

                    }
                }
            ]
        });

        function deleteTag(id, element) {

            if (confirm("Emin misiniz ?")) {
                $.ajax({
                    url: '/Tag/DeleteAjax',
                    type: 'POST',
                    data: { id: id },
                    success: function () {
                        //DataTable.ajax.reload();
                        let satir = $(element).parent().parent();
                        DataTable.row(satir).remove().draw();
                    }
                });
            }


        }


    </script>
    @*  <script>
        function deleteTag(id, element) {
            if (confirm("Silmek istediğinizden emin misiniz?")) {
                $.ajax({
                    url: 'Tag/DeleteAjax',
                    type: 'POST',
                    data: { id: id, name: "" },
                    success: function () {
                        alert("Silme işlemi başarılı");
                        // $("#satir-" + id).remove();
                        $(element).parent().parent().remove();

                    }
                });
            }
            else {
                alert("İşlemden vazgeçtiniz");
            }
        }
    </script> *@
}